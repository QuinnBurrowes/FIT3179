<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Australian Health Insights Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: #fafafa;
      margin: 18px;
      color: #111827;
      line-height: 1.55;
    }

    h1, h2, h3 {
      text-align: center;
      font-weight: 600;
    }

    h1 { margin-bottom: 8px; }
    h2 { margin-top: 40px; margin-bottom: 12px; }
    h3 {
      margin-bottom: 10px;
      margin-top: 20px;
      font-weight: 500;
      color: #1f2937;
    }

    p.lead {
      text-align: center;
      color: #374151;
      max-width: 800px;
      margin: 0 auto 24px auto;
    }

    .top-row {
      display: flex;
      gap: 48px;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .map-card, .chart-card, .chart {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 6px 18px rgba(15,23,42,0.06);
      padding: 12px;
      box-sizing: border-box;
    }

    .map-card { width: 680px; }
    .chart-card {
      width: calc(100% - 36px);
      max-width: 1380px;
      margin: 12px auto;
    }

    .section-2 {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 160px;
      flex-wrap: wrap;
      width: 100%;
      max-width: 1500px;
      margin: 0 auto 20px auto;
    }

    .chart-row {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 160px;
      flex-wrap: wrap;
      margin-top: 20px;
      margin-bottom: 20px;
    }

    /* slightly wider charts for section 2 and 3 */
    .chart {
      width: 520px;
      max-width: 100%;
    }

    .caption, .text-block {
      margin-top: 8px;
      font-size: 14px;
      color: #374151;
      text-align: center;
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
    }

    @media (max-width: 1450px) {
      .map-card { width: 48%; }
      .section-2, .chart-row { gap: 120px; }
      .chart { width: 460px; }
    }

    @media (max-width: 900px) {
      .map-card { width: 100%; }
      .chart { width: 100%; }
      .section-2, .chart-row { gap: 80px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Physical, Mental, and Lifestyle Health in Australia</h1>
    <p class="lead">
      Visual exploration of national health indicators across physical activity, mental wellbeing, and lifestyle factors.
      <br>
      Data sources: Australian Bureau of Statistics (National Health Survey 2022) and AIHW.
    </p>
  </header>

  <!-- SECTION 1 -->
  <h2>National and State Health Overview</h2>
  <div class="top-row">
    <div class="map-card">
      <h3>Mental Health Conditions by State (2022)</h3>
      <div id="map1"></div>
    </div>

    <div class="map-card">
      <h3>Physical Activity Adherence by State (2022)</h3>
      <div id="map2"></div>
    </div>
  </div>

  <div class="text-block">
    The maps highlight regional disparities in physical and mental health across Australia. 
    States with higher physical activity rates tend to report lower mental health concerns, indicating a possible association.
  </div>

  <div class="chart-card">
    <h3>Leading Causes of Death in Australia (2014â€“2022)</h3>
    <div id="deaths"></div>
  </div>

  <!-- SECTION 2 -->
  <h2>Lifestyle and Nutrition Patterns</h2>
  <div class="section-2">
    <div class="chart">
      <h3>Dietary Recommendation Compliance by Age Group</h3>
      <div id="heatmap"></div>
    </div>

    <div class="chart">
      <h3>Weekly Physical Activity Levels by Age Group</h3>
      <div id="donut"></div>
    </div>
  </div>

  <div class="text-block">
    Diet and physical activity play central roles in population health.  
    Younger age groups are less likely to meet fruit and vegetable recommendations, however, are more likely to meet the physical activity requirements. The opposite is true for older age groups.
  </div>

  <!-- SECTION 3 -->
  <h2>Psychological Wellbeing and Physical Activity</h2>
  <div class="chart-row">
    <div class="chart">
      <h3>Relationship Between Physical Activity and Distress</h3>
      <div id="scatter"></div>
    </div>

    <div class="chart">
      <h3>Psychological Distress Levels by Age and Gender</h3>
      <div id="stacked"></div>
    </div>
  </div>

  <div class="text-block">
    Data illustrating the prevalence of physical and mental health conditions in different demographics of geography, age group and gender, together with their links to lifestyle factors of physical activity and fruit/vegetable consumption can inform the design of targeted wellbeing and health promotion strategies.
  </div>

  <script>
    const embedOpts = { actions: false, renderer: "canvas" };

    /* ---------------- SECTION 1 MAPS ---------------- */
    const specMap1 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 680, "height": 420,
      "projection": { "type": "mercator", "center": [134, -28], "scale": 600 },
      "layer": [
        { "data": { "graticule": { "step": [30, 30] } }, "mark": { "type": "geoshape", "stroke": "#ddd", "strokeWidth": 0.4 } },
        {
          "data": { "url": "https://raw.githubusercontent.com/tonywr71/GeoJson-Data/master/australian-states.json", "format": { "type": "json", "property": "features" } },
          "transform": [
            {
              "lookup": "properties.STATE_NAME",
              "from": {
                "data": { "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/mental_state_real.csv" },
                "key": "STATE_NAME",
                "fields": ["value"]
              }
            }
          ],
          "mark": { "type": "geoshape", "stroke": "white", "strokeWidth": 1 },
          "encoding": {
            "color": { "field": "value", "type": "quantitative", "title": "% adults (mental)", "scale": { "scheme": "blues" } },
            "tooltip": [
              { "field": "properties.STATE_NAME", "title": "State" },
              { "field": "value", "title": "% adults (mental)" }
            ]
          }
        }
      ],
      "config": { "legend": { "orient": "left", "offset": 10 }, "view": { "stroke": "transparent" } }
    };

    const specMap2 = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 680, "height": 420,
      "projection": { "type": "mercator", "center": [134, -28], "scale": 600 },
      "layer": [
        { "data": { "graticule": { "step": [30, 30] } }, "mark": { "type": "geoshape", "stroke": "#ddd", "strokeWidth": 0.4 } },
        {
          "data": { "url": "https://raw.githubusercontent.com/tonywr71/GeoJson-Data/master/australian-states.json", "format": { "type": "json", "property": "features" } },
          "transform": [
            {
              "lookup": "properties.STATE_NAME",
              "from": {
                "data": { "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/physical_state.csv" },
                "key": "STATE_NAME",
                "fields": ["value"]
              }
            }
          ],
          "mark": { "type": "geoshape", "stroke": "white", "strokeWidth": 1 },
          "encoding": {
            "color": { "field": "value", "type": "quantitative", "title": "% adults (physical)", "scale": { "scheme": "greens" } },
            "tooltip": [
              { "field": "properties.STATE_NAME", "title": "State" },
              { "field": "value", "title": "% adults (physical)" }
            ]
          }
        }
      ],
      "config": { "legend": { "orient": "right" }, "view": { "stroke": "transparent" } }
    };

    /* ---------------- OTHER CHARTS ---------------- */
    const specDeaths = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "data": { "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/death_causes.csv" },
      "mark": "line",
      "encoding": {
        "x": { "field": "Year", "type": "quantitative", "axis": { "format": "d" }},
        "y": { "field": "Deaths", "type": "quantitative" },
        "color": { "field": "Cause", "type": "nominal" }
      },
      "width": 1000, "height": 380
    };

    const specHeatmap = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "data": { "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/fruit_veg_data.csv" },
      "width": 460,
      "height": 260,
      "mark": "rect",
      "encoding": {
        "x": { "field": "AgeGroup", "type": "ordinal", "axis": { "title": "Age Group" } },
        "y": { "field": "RecommendationType", "type": "nominal", "axis": { "title": "Recommendation Type" } },
        "color": { "field": "MetPercent", "type": "quantitative", "title": "Meeting (%)", "scale": { "scheme": "yellowgreenblue" } }
      },
      "config": { "view": { "stroke": "transparent" } }
    };

    const specDonut = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "data": { "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/physical_activity_final.csv" },
      "params": [
        {
          "name": "ageSelect",
          "value": "15-17",
          "bind": { "input": "select", "options": ["15-17","18-24","25-34","35-44","45-54","55-64","65+"], "name": "Select Age Group: " }
        }
      ],
      "transform": [{ "filter": "datum.Age_Group == ageSelect" }],
      "width": 420,
      "height": 340,
      "mark": { "type": "arc", "innerRadius": 70 },
      "encoding": {
        "theta": { "field": "Proportion", "type": "quantitative" },
        "color": {
          "field": "Minutes_Category",
          "type": "nominal",
          "scale": {
            "domain": ["0 minutes", "1-149 minutes", "150-299 minutes", "300+ minutes"],
            "range": ["#d73027", "#fc8d59", "#fee090", "#1a9850"]
          },
          "legend": { "title": "Minutes per Week" }
        }
      },
      "config": { "view": { "stroke": null } }
    };

    const specScatter = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "width": 520,
      "height": 400,
      "data": {
        "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/activity_vs_distress.csv"
      },
      "layer": [
        {
          "mark": { "type": "point", "filled": true, "size": 140 },
          "encoding": {
            "x": { "field": "Activity_Met", "type": "quantitative", "title": "% meeting activity guidelines" },
            "y": { "field": "Distress_High", "type": "quantitative", "title": "% high/very high distress" },
            "color": { "field": "Age_Group", "type": "nominal" }
          }
        },
        {
          "data": {
            "values": [
              {
                "x1": 22,
                "y1": 20,
                "x2": 17.5,
                "y2": 20,
                "label": "Outlier:\nHigh activity, high distress for 18-24"
              },
              {
                "x1": 15,
                "y1": 15,
                "x2": 15,
                "y2": 13.5,
                "label": "Trend:\nLower activity,\nhigher distress"
              }
            ]
          },
          "layer": [
            {
              "mark": {
                "type": "rule",
                "stroke": "#555",
                "strokeWidth": 1.5
              },
              "encoding": {
                "x": { "field": "x1", "type": "quantitative" },
                "x2": { "field": "x2" },
                "y": { "field": "y1", "type": "quantitative" },
                "y2": { "field": "y2" }
              }
            },
            {
              "mark": {
                "type": "text",
                "align": "right",
                "baseline": "middle",
                "dx": -6,
                "dy": 0,
                "fontSize": 12,
                "fontWeight": "bold",
                "color": "#111827"
              },
              "encoding": {
                "x": { "field": "x2", "type": "quantitative" },
                "y": { "field": "y2", "type": "quantitative" },
                "text": { "field": "label" }
              }
            }
          ]
        }
      ],
      "config": { "view": { "stroke": "transparent" } }
    };


    const specStacked = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "data": { "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/psychological_distress.csv" },
      "transform": [
        { "filter": { "field": "Sex", "oneOf": ["Males", "Females"] } },
        { "calculate": "toNumber(datum.Percent)", "as": "PercentNum" }
      ],
      "facet": { "row": { "field": "Sex", "type": "nominal" } },
      "spec": {
        "mark": { "type": "bar", "cornerRadiusEnd": 2 },
        "encoding": {
          "y": { "field": "AgeGroup", "type": "ordinal" },
          "x": { "field": "PercentNum", "type": "quantitative" },
          "color": {
            "field": "DistressLevel",
            "type": "nominal",
            "scale": {
              "domain": ["Low distress level", "Moderate distress level", "High distress level", "Very high distress level"],
              "range": ["#4daf4a", "#377eb8", "#ff7f00", "#e41a1c"]
            }
          }
        }
      },
      "resolve": { "legend": { "color": "shared" } },
      "width": 420,
      "height": 280
    };

    /* Embed all specs */
    vegaEmbed("#map1", specMap1, embedOpts);
    vegaEmbed("#map2", specMap2, embedOpts);
    vegaEmbed("#deaths", specDeaths, embedOpts);
    vegaEmbed("#heatmap", specHeatmap, embedOpts);
    vegaEmbed("#donut", specDonut, embedOpts);
    vegaEmbed("#scatter", specScatter, embedOpts);
    vegaEmbed("#stacked", specStacked, embedOpts);
  </script>
</body>
</html>
