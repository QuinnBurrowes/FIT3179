<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Health Risks and Causes of Death in Australia</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background: #f9f9f9;
      text-align: center;
    }

    h1 {
      margin-bottom: 40px;
    }

    .vis-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 40px auto;
      text-align: center;
    }

    footer {
      margin-top: 60px;
      font-size: 14px;
      color: #555;
    }
  </style>
</head>

<body>

  <h1>Overweight, Obesity & Health Outcomes in Australia</h1>
  <p>
    This visualisation explores the relationship between obesity prevalence and major causes of death in Australia.
    Data is sourced from the Australian Bureau of Statistics (2022) and the Australian Institute of Health and Welfare (AIHW).
  </p>

  <!-- Adult Overweight Map -->
  <h2>Adult Overweight/Obesity Prevalence by State (2022)</h2>
  <div class="vis-container" id="adult-vis"></div>

  <!-- Child Overweight Chart -->
  <h2>Prevalence of Overweight or Obese Children (2–17 years)</h2>
  <div class="vis-container" id="child-vis"></div>

  <!-- Death Causes Over Time -->
  <h2>Trends in Major Causes of Death (2014–2023)</h2>
  <div class="vis-container" id="death-vis"></div>

  <script type="text/javascript">
    // Adult Overweight Map
    var adultSpec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "description": "Obesity prevalence by Australian state",
      "width": 600,
      "height": 500,
      "projection": {"type": "mercator", "center": [134, -28], "scale": 600},
      "layer": [
        {"data": {"graticule": {"step": [30, 30]}},
         "mark": {"type": "geoshape", "stroke": "#3b3b3b", "strokeWidth": 0.5}},
        {
          "data": {
            "url": "https://raw.githubusercontent.com/tonywr71/GeoJson-Data/master/australian-states.json",
            "format": {"type": "json", "property": "features"}
          },
          "transform": [{
            "lookup": "properties.STATE_NAME",
            "from": {
              "data": {"url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/health_risks_real.csv"},
              "key": "STATE_NAME",
              "fields": ["value"]
            }
          }],
          "mark": {"type": "geoshape", "stroke": "white", "strokeWidth": 1},
          "encoding": {
            "color": {
              "field": "value",
              "type": "quantitative",
              "title": "% overweight adults",
              "scale": {"scheme": "reds"}
            },
            "tooltip": [
              {"field": "properties.STATE_NAME", "title": "State"},
              {"field": "value", "title": "% overweight adults"}
            ]
          }
        }
      ],
      "config": {"view": {"stroke": "transparent"}, "background": "#7fcdff"}
    };

    // Child Overweight Chart (interactive + average line)
    var childSpec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": {
        "text": "Prevalence of Overweight or Obese Children in Australia (2–17 years)",
        "fontSize": 18,
        "fontWeight": "bold"
      },
      "data": {
        "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/child_overweight.csv"
      },
      "transform": [
        {"filter": "datum.Category == 'Overweight or obese'"},
        {"filter": "genderSelect == 'All' ? true : datum.Gender == genderSelect"}
      ],
      "params": [
        {
          "name": "genderSelect",
          "value": "Boys",
          "bind": {
            "input": "select",
            "options": ["All", "Boys", "Girls"],
            "labels": ["All", "Boys only", "Girls only"],
            "name": "Select Gender: "
          }
        }
      ],
      "width": 600,
      "height": 350,
      "layer": [
        {
          "mark": "bar",
          "encoding": {
            "x": {
              "field": "AgeGroup",
              "type": "ordinal",
              "title": "Age Group",
              "sort": ["2-4", "5-7", "8-11", "12-15", "16-17"]
            },
            "y": {
              "field": "Percent",
              "type": "quantitative",
              "title": "Prevalence (%)",
              "scale": {"domain": [0, 40]}
            },
            "color": {
              "field": "Gender",
              "type": "nominal",
              "title": "Gender",
              "scale": {"domain": ["Boys", "Girls"], "range": ["#1f77b4", "#ff7f0e"]}
            },
            "tooltip": [
              {"field": "AgeGroup", "type": "ordinal"},
              {"field": "Gender", "type": "nominal"},
              {"field": "Percent", "type": "quantitative", "format": ".1f"}
            ]
          }
        },
        {
          "mark": {"type": "rule", "color": "red", "strokeDash": [4, 2]},
          "encoding": {"y": {"datum": 26.4}}
        },
        {
          "mark": {"type": "text", "color": "red", "dx": 5, "dy": -5, "align": "left"},
          "encoding": {
            "y": {"datum": 26.4},
            "x": {"value": 0},
            "text": {"value": "All children (2–17) = 26.4%"}
          }
        }
      ]
    };

    // Death Causes Over Time
    var deathSpec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": {
        "text": "Trends in Major Causes of Death in Australia (2014–2023)",
        "fontSize": 18,
        "fontWeight": "bold",
        "anchor": "start"
      },
      "width": 600,
      "height": 400,
      "data": {
        "url": "https://raw.githubusercontent.com/QuinnBurrowes/FIT3179/main/death_causes_old.csv"
      },
      "mark": {"type": "line", "point": true, "strokeWidth": 3},
      "encoding": {
        "x": {"field": "Year", "type": "temporal", "axis": {"title": "Year"}},
        "y": {"field": "Deaths", "type": "quantitative", "axis": {"title": "Number of Deaths"}},
        "color": {"field": "Cause", "type": "nominal", "legend": {"title": "Cause of Death"}},
        "tooltip": [{"field": "Year"}, {"field": "Cause"}, {"field": "Deaths"}]
      },
      "config": {
        "view": {"stroke": "transparent"},
        "axis": {"labelFontSize": 12, "titleFontSize": 14},
        "legend": {"labelFontSize": 12, "titleFontSize": 13}
      }
    };

    // Embed charts
    vegaEmbed('#adult-vis', adultSpec);
    vegaEmbed('#child-vis', childSpec);
    vegaEmbed('#death-vis', deathSpec);
  </script>

  <footer>
    <p>Created by Quinn Burrowes | FIT3179 Data Visualisation 2 | Monash University, Semester 2, 2025</p>
    <p>Data Sources: Australian Bureau of Statistics (2022); Australian Institute of Health and Welfare (2024)</p>
  </footer>

</body>
</html>
